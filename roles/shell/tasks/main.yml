---
- name: install bash_profile
  template: >
    src=dotfiles/bash_profile
    dest={{ home }}/.bash_profile

- name: make sure .bash.d dir exists on target
  file: path={{ home }}/.bash.d state=directory

- name: install .bash.d dir
  synchronize: >
    src="dotfiles/bash.d/"
    dest={{ home }}/.bash.d

- name: make sure .marks dir exists on target
  file: path={{ home }}/.marks state=directory

- name: grab the tmux source
  git: >
    repo=git://git.code.sf.net/p/tmux/tmux-code
    dest=~/src/tmux
    version=1.9a

- name: configure and make tmux
  register: build_tmux
  shell: cd ~/src/tmux && bash -lc "sh autogen.sh && ./configure && make"

- name: install tmux
  when: build_tmux|changed
  sudo: yes
  shell: cd ~{{ ansible_user_id }}/src/tmux && bash -lc "make install"

- include: "Darwin_reqs.yml"
  when: os_family == "Darwin"

- include: "RedHat_reqs.yml"
  when: os_family == "RedHat"

- include: "Debian_reqs.yml"
  when: os_family == "Debian"

